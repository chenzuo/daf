CREATE TABLE [dbo].[sso_User] (
    [UserId] [nvarchar](50) NOT NULL,
    [Account] [nvarchar](50) NOT NULL,
    [Password] [nvarchar](50) NOT NULL,
    [ClientId] [nvarchar](50),
    [SecurityCode] [nvarchar](256),
    [NickName] [nvarchar](50),
    [FullName] [nvarchar](50),
    [Sex] [int],
    [Birthday] [datetime],
    [Email] [nvarchar](50),
    [Mobile] [nvarchar](50),
    [Locale] [nvarchar](10),
    [TimeZone] [float] NOT NULL,
    [Theme] [nvarchar](20),
    [Skin] [nvarchar](20),
    [Avatar] [nvarchar](200),
    [Status] [int] NOT NULL,
    CONSTRAINT [PK_dbo.sso_User] PRIMARY KEY ([UserId])
)
CREATE TABLE [dbo].[sso_UserRole] (
    [UserId] [nvarchar](50) NOT NULL,
    [RoleId] [nvarchar](50) NOT NULL,
    CONSTRAINT [PK_dbo.sso_UserRole] PRIMARY KEY ([UserId], [RoleId])
)
CREATE INDEX [IX_UserId] ON [dbo].[sso_UserRole]([UserId])
CREATE INDEX [IX_RoleId] ON [dbo].[sso_UserRole]([RoleId])
CREATE TABLE [dbo].[sso_Role] (
    [RoleId] [nvarchar](50) NOT NULL,
    [ClientId] [nvarchar](50),
    [RoleName] [nvarchar](50) NOT NULL,
    [ActiveTime] [datetime],
    [ExpiryTime] [datetime],
    [Status] [int] NOT NULL,
    [ParentRoleId] [nvarchar](50),
    CONSTRAINT [PK_dbo.sso_Role] PRIMARY KEY ([RoleId])
)
CREATE INDEX [IX_ParentRoleId] ON [dbo].[sso_Role]([ParentRoleId])
CREATE TABLE [dbo].[sso_RolePermission] (
    [RoleId] [nvarchar](50) NOT NULL,
    [ClientId] [nvarchar](50) NOT NULL,
    [PermissionType] [int] NOT NULL,
    [Permissions] [nvarchar](max) NOT NULL,
    CONSTRAINT [PK_dbo.sso_RolePermission] PRIMARY KEY ([RoleId], [ClientId], [PermissionType])
)
CREATE INDEX [IX_RoleId] ON [dbo].[sso_RolePermission]([RoleId])
CREATE TABLE [dbo].[sso_Permission] (
    [ClientId] [nvarchar](50) NOT NULL,
    [PermissionName] [nvarchar](50) NOT NULL,
    [PermissionType] [int] NOT NULL,
    [Position] [int] NOT NULL,
    [Uri] [nvarchar](200) NOT NULL,
    [GroupName] [nvarchar](50),
    CONSTRAINT [PK_dbo.sso_Permission] PRIMARY KEY ([ClientId], [PermissionName], [PermissionType])
)
CREATE TABLE [dbo].[sso_ServerSession] (
    [SessionId] [nvarchar](128) NOT NULL,
    [CientId] [nvarchar](50) NOT NULL,
    [FromCientId] [nvarchar](50),
    [FromSessionId] [nvarchar](50),
    [DeviceId] [nvarchar](50),
    [DeviceInfo] [nvarchar](500),
    [UserId] [nvarchar](50),
    [AccessToken] [nvarchar](50),
    [AccessTokenExpiryTime] [datetime],
    [LastAccessTime] [datetime],
    CONSTRAINT [PK_dbo.sso_ServerSession] PRIMARY KEY ([SessionId], [CientId])
)
CREATE UNIQUE INDEX [IX_Account] ON [dbo].[sso_User]([Account])
CREATE INDEX [IX_Email] ON [dbo].[sso_User]([Email])
CREATE INDEX [IX_Mobile] ON [dbo].[sso_User]([Mobile])
CREATE UNIQUE INDEX [IX_RoleName] ON [dbo].[sso_Role]([RoleName])
ALTER TABLE [dbo].[sso_UserRole] ADD CONSTRAINT [FK_dbo.sso_UserRole_dbo.sso_User_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[sso_User] ([UserId]) ON DELETE CASCADE
ALTER TABLE [dbo].[sso_UserRole] ADD CONSTRAINT [FK_dbo.sso_UserRole_dbo.sso_Role_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[sso_Role] ([RoleId]) ON DELETE CASCADE
ALTER TABLE [dbo].[sso_Role] ADD CONSTRAINT [FK_dbo.sso_Role_dbo.sso_Role_ParentRoleId] FOREIGN KEY ([ParentRoleId]) REFERENCES [dbo].[sso_Role] ([RoleId])
ALTER TABLE [dbo].[sso_RolePermission] ADD CONSTRAINT [FK_dbo.sso_RolePermission_dbo.sso_Role_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[sso_Role] ([RoleId]) ON DELETE CASCADE
CREATE TABLE [dbo].[__MigrationHistory] (
    [MigrationId] [nvarchar](255) NOT NULL,
    [Model] [varbinary](max) NOT NULL,
    [ProductVersion] [nvarchar](32) NOT NULL,
    CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId])
)
BEGIN TRY
    EXEC sp_MS_marksystemobject 'dbo.__MigrationHistory'
END TRY
BEGIN CATCH
END CATCH
INSERT INTO [__MigrationHistory] ([MigrationId], [Model], [ProductVersion]) VALUES ('201212101427116_Init', 0x1F8B0800000000000400ED5D4B6F1C3712BE2F90FF3098D36681CC4872B2B08D5102792405C65A92A19673D88B41755323C2FD4A376732FA6D7BD89FB47F61C97EF2D94D76731ECAEEC5D0F0F155912C168BD555F47FFEF5EFC52FDB289C6C6096A3243E9F9ECE4EA61318FB4980E2D5F9748D9F7E783BFDE5E7EFFEB2B80AA2EDE4B7BADD1BDA8EF48CF3F3E933C6E9FBF93CF79F6104F25984FC2CC993273CF393680E82647E7672F26E7E7A3A8704624AB02693C5FD3AC62882C50FF27399C43E4CF11A84374900C3BC2A27355E813AB90511CC53E0C3F3E9E5C5F5CCF3EE661ECC08DB330F6138BBFC309D5C8408106E3C183E4D27E98FEFBFE4D0C35912AFBC146004C287971492FA2710E6B0E2FD7DFAA329FB276794FD3988E30413B8241E34FC69333032B42B3205F885B2550CEF7C4A38CED816A4CD3FE00B57408A3E67490A33FC720F9F987E1F83E964CEF79D8B9D9BAE423FCA0299389C91359F4EAED116069F60BCC2CFCD6CDD806D5DF21359F82F31221242FAE06C4D6A6FD761081E43D8349F7792BDF0FD842CFFDEE97E0679FE4792ED7FC0CB10C118BB9DE9F277375D0FFAEB8C88D8922058D23EFBE9EF2389DF22FF1BFD6BDF83BE26AD0F41D783DB86245141B3E2B71DC40794E1E700BCD4389700C3071459B372150114EE7BFC37C9230AF73EEB9F121F58533D1D4B952ECA3F93B8A17B99AC1F437BBDF0404E0CEB8D395A4EBFA178DF342F360083CC9AEAE8A192937A9D73BB926C295017F7ADD62DD8A05571D62BCECDFB248404E31E86458BFC19A51589BAF66B719C4FAEB324A23FDB6E45C5D70790AD203D041355AD97AC335F6069316F2D865E3B8242B9B325944D2989576476D4ECEE9A6CA7D88C91985A26D41253CB9329378580747253B6507053FCA3E5A6F847C58DB1FC0E95DDA102B92FC93812B3900ED7B5856468F863B4A92C9A9116CE3645D98B0BA491678474C5C8C892BA9727E548B45BBBE442B9B98BCD59D7B75B9B299636365B67AB6496CF280C48CFA1BC8887A48A4FE359C9D08658A82BCDB14DA13FC32C4239F57048CA4F51ADE44E6C63CB25ED4455698F6DD1AD9BB5B68596252BDDDC8ED19D9656366D35A441E3962BCAEEFFF42960A6AB84F96234A058351839B71C15F9D39DBDA5B570066C759552D4A98341FB6ADC9E1AB8514A2B600F7BEB0884FC2016CF0EF75892A3D20D5D627E8CF19B336B942F19727A2B3722FA6B96ACD3DDBBE88CB75EF921C18383775FD5D5F450536FD5FE4DC490B173779DBD1D7D481D68FB52A5BC03DA467E64427AE88C8F267E0937C8DFC71D424D377E4AAC298F25EDDE2B64E499F47DB2C60FC93768EB147549DADD75F613C871056C8DA65798EB885397C446FB985F8760D57E4EFD1207300B5FC8C4B1C711CFEA0D8C1E61566F2F18158EFBDF40B8263F4FA48171AD6FD8B6A732DB25831D4CB377FAD1BCDF2619615EC78FD8FA1E82E02E0E5F9AF667DDED3F25FE371834ADDF74B7BE8421C44CF377EF06CC8E688B8C9EA13B2293D55772B349A2EB738D601898CE52B1A07E9242DD44A9077E91E7898F0AD60467F957C5D7F7AB3898747A625B73AEF1B94F6ED6214669887CB295CEA77F9386A1036D2EED3CA808783A154D8CBBB8148209F5AFD1E08C25C87D1028CC74429A2F215609A4CE1404C225B922E10CA018CB260C8A7D9482B08B6DA193DDB785794342ACB9842924C217E3AE751847BB21214C56DFDC2CE68C3075CB18EBE9D20983D205D78A82AD6C29BD68DD7027B399BC4B07498882B8C91A693D43E6F2A1984513CABCDFF66032223A25BA1657EBA1E01799F12B584A8FD6DBD92D4587D74F1DCCEF510A35EB338E833DC821EF62EE3DBA74B237EA3C7C5DF2A6647B4F92A65C872393B1F25641FA60D2A331E03CEFEEF283245FB4A50731238BC4606FAF259C5D24C991DCB98AD2500294C2D403A20330EECCF9C29530AC86EE01EC06B300E25C5E2A2CDE2726C2310B2DCF7715C5C0B45186398872D7676B3743E0565612DF3EEB5A809120382926CD0C06CE7DC79487AD35FE7ACD3F86D7FEE1AA0CBE3E80818395BE9DA807DD69CD18DB33C218B82DD0331D3A0B6607D3227C98ED10FE9EA9501FACC385DFD5C06BE750A3C69BBAC5BC8CD1AF0A16734D30FFE206A4298A574C707F5532F1CAC8FEE50F9E7D547D5462CCFD5C115CDF70DB50C249065650A825A409A7D728CB31F52B3C02EAF4580691D4ACF3D0AA69B06797BC42B5A2AD5BD3BF2B978632B161A6D296EDDC5D93E144D41EA02383829CC8DD2634A3028420D3785F9749B88EE2EE2BB31EA589EC67619A42739C36529F056A4BCD91DA0F8F2C92FE73A91E890FA667D1F81A73C436429E456B4BCD91DA987716A92DB519E5561CDCD6A67F1BC2CE82B4A5E64855103B0B53159963D431E92C485D668E52C798B3287599394A1B33CEE2B4A5164865D83807531659AC731105CE2D745162B1D7AB986E6EAB5765167C543E798E93AA4C4659CC05AD275D5E24FD2ADDF878656DACCACBF3D2913A57D900862A5DDD75B76ABDBE2BB228BAFBE3C116C9D9020D5C1CBB85B19BD2DD9F6E94B67C82B4A53636401BE4CB9B016DB9C529C07C19E58E02A67C57DA466F9DB0CE62DE42E972231F746BB0F726479B4417B256609A6C972E80D7B271C44FA79C387446CD99A1E63AC8633A201D0BD728C11A2254BB1007599BF6C55DEE5DC89A10420EAF2935472AC208391B831698F76722025914A6F868445DF09C3A90F68EF0C302B24FE07BFAEB6F7A4D6C1B7FDFD3C632EAB196CAED63BF7BB8703FEE2ACB56D8E169C629549963B6A1792C5C5B6A8D5404DB29B08A728B3DE8CA83D3C6C3095E9CB662109ECE94D334B1B89F0B316FDC3D5DA8DBB31E91BCA66293867AE33D15BCA48BCA63D9FF2E8AE4C22C9B4C2764BA362828DC972F39865191E036F37E0FCB03AE6D700362F404735CAC4511EAFD56785665C09327F33C0FC2637EF724DE80CC7FA66E0B21BA73DCB326AE60C5574B5CE18A291906B843DF1C5142172F8C8C7B52C411CBE28B21CE66A279100451B118F716480030C463DF02713432FEA90F47A0FC4B1E4AD0536B50F1A18EA73001D87AAB70EF74A885D95E3A9867381C41F2AF6C6840ED19E512A40549564CDF9FF3950A575AB7E6660CEA2B7947E1C80FAAD6B7E9DA0C101F3918ACBAA5AC90A148B67B586585C80F1B0C5A88FF279A1FCF361991C23A4886E4B4F09AC9BF4660FBBD2BB5374E6A5E5B2AB5FB75DE855674284542E2F3100C26EDD9C44C1A96D5BC5BF5F86A9396D5963D4D511E9793EC4A521529C7AEEE99AA8C6247D862C2B05B58261F58036C8D6C6D5E0FCCE6758FECCE2C5327EB9AA1E914C59804C7FDE61ECAC1AA03134806276DEC3B69F1F81315CD927FA4B5DA795ECE6165C578ED1C26F41C5B12CFF0A4D66179A73C46F9F5C13A1DF6E857BB199B09BD5798A47A282D21E6558D488A7D1532D419317384C97F72BA85B892722E9F360FB0FCCE490CA7476AA596061361E6AB5596606792601705E34C406D16A10E7D408EA1418A611735B65D0FDD4E9A26F42C6809C9887DC98A3A8A87CE6994D2B88C32B894C95F16895BBD431B9BB12631A96270AF43632D9351099976C36A0D959E5EC79476693F4479E7AB027ACD876C915928C7C2909389F99F84C8D998A3550B41FF5FA118FADC99D4B4A15E8DFA681438AA9B88DFBD2106E4760E2E328C9E808F4935BDBC17AF85558F105D458F30F818DFAD71BAC664C8307A0CB9B4277AC476D12FD227799E177769F180A98B211036117530DCC51FD688796DE95AE16FD740D0B3FB5718570F3C79C414C070D5BE6E752B6533E980AAE96B4C8E0718A52101CBEF620F6CA09EB7FE39E4676C7189C02A03515E61B4FDC94F227E41B4FDF9BF5F8821650B6B0000, '5.0.0.net45')
